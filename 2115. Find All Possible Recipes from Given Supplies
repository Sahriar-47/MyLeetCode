class Solution {
    public List<String> findAllRecipes(String[] recipes, List<List<String>> ingredients, String[] supplies) {
        
        Set<String> sup = new HashSet<>();
        for(String str: supplies) {
            sup.add(str);
        }

        Map<String, Integer> recToIdx = new HashMap<>();
        for(int i=0; i<recipes.length; i++) {
            recToIdx.put(recipes[i], i);
        }

        int[] indegree = new int[recipes.length];
        Map<String, List<String>> adj = new HashMap<>();
        for(int i=0; i<recipes.length; i++) {
            for(String ing: ingredients.get(i)) {
                if(!sup.contains(ing)) {
                    adj.putIfAbsent(ing, new ArrayList<>());
                    adj.get(ing).add(recipes[i]);
                    indegree[i]++;
                }
            }
        }

        Queue<Integer> q = new LinkedList<>();
        for(int i=0; i<recipes.length; i++) {
            if(indegree[i] == 0) {
                q.add(i);
            }
        }

        List<String> ans = new ArrayList<>();
        while(!q.isEmpty()) {
            int recIdx = q.poll();
            String rec = recipes[recIdx];
            ans.add(rec);

            if(!adj.containsKey(rec)) continue;
            
            for(String str: adj.get(rec)) {
                indegree[recToIdx.get(str)]--;
                if(indegree[recToIdx.get(str)] == 0) {
                    q.add(recToIdx.get(str));
                }
            }
        }

        return ans;
    }
}
